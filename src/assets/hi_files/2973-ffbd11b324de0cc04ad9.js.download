(self.webpackChunk_loomhq_web_client=self.webpackChunk_loomhq_web_client||[]).push([[2973],{28729:function(e,n,i){"use strict";i.d(n,{Bp:function(){return d},Rf:function(){return l},Tr:function(){return t},cb:function(){return m},d0:function(){return a},d6:function(){return u},dS:function(){return s},e6:function(){return c},nL:function(){return r},p2:function(){return o}});let t="google",a="google-id-token",r="slack",o="slack-openid-connect",d="windows",l="auth0",s="apple",c="workos",u="atlassian",m=[l,c]},71341:function(e,n,i){"use strict";i.d(n,{BG:function(){return r},VN:function(){return o},Zx:function(){return d},wu:function(){return a}});var t=i(39419);let a=e=>({type:t.z9,err:e}),r=e=>({type:t.Q5,isFetching:e}),o=e=>({type:t.TY,err:e}),d=e=>({type:t.x9,err:e})},77961:function(e,n,i){"use strict";i.d(n,{C:function(){return o}});var t=i(40240),a=i(31245),r=i.n(a);let o=async(e,n)=>{let i=(0,t.J$)(),{data:{acceptInviteLinkInvitation:a}}=await i.mutate({mutation:r(),variables:{inviteLinkId:e,isNewUser:n}});return a}},32973:function(e,n,i){"use strict";i.d(n,{ZJ:function(){return B},b2:function(){return R},fi:function(){return G},l$:function(){return q},x4:function(){return C}});var t=i(93185),a=i(49003),r=i(80396),o=i(59298),d=i(44314),l=i(40240),s=i(68213),c=i(87480),u=i(14374),m=i(71907),v=i(7910),k=i(39808),f=i(71022),p=i(94713),y=i(21722),h=i(28729),g=i(99532),S=i(54581),N=i(58461),w=i(85578),b=i(71341),I=i(19370),E=i.n(I),F=i(83380),L=i.n(F),_=i(21924),T=i(80935),U=i(77961),D=i(95180),A=i(27584);i(16479);var P=i(16585);let{hex:O}=p;function V(e){return"object"==typeof e&&null!==e&&"created"in e&&"boolean"==typeof e.created&&"error"in e&&("string"==typeof e.error||null===e.error)&&"loginSuccess"in e&&"boolean"==typeof e.loginSuccess&&"type"in e&&"string"==typeof e.type&&"userRole"in e&&"string"==typeof e.userRole&&(!("redirect_after"in e)||"string"==typeof e.redirect_after)}let $=e=>{(0,l.J$)().mutate({mutation:L(),variables:{name:w.BR.SIGNUP_LOCATION,value:e}}).then(({data:e})=>{let{success:n}=e;return n})},Z=()=>{try{(0,c.k)().then(e=>{$(e.country)}).catch(e=>{u.warning(e,{message:"Failed to get update location",team:N.SZ.Billing})})}catch(e){u.warning(e,{message:"Failed to get fetch location",team:N.SZ.Billing})}},x=async e=>{let n;let i=e.deeplink_uri;if(e.invalidLogin||i&&(0,D.Z)(i)){(0,k.dq)();return}let t=(0,v.jS)("redirect_after"),r=(0,v.jS)("orgToken")||(0,v.jS)("orgTokenForMemberPreview"),o=(0,v.jS)("invite_link_id"),d=(0,v.jS)("companyID"),l=(0,v.jS)("redirect");if(d&&O(d)&&l&&!(0,D.Z)(l)){window.location.reload();return}if(e.loginSuccess){if(e.created){n=new URL(a.OA+a.n4);try{await Z()}catch(e){u.warning(e,{message:"unable to update user location",team:N.SZ.Billing})}}else if(t){let e=window.decodeURIComponent(t);(0,D.Z)(e)&&(e="/"),n=new URL(e,a.OA)}else if(e.redirect_after){let i=window.decodeURIComponent(e.redirect_after);(0,D.Z)(i)&&(i="/"),n=new URL(i,a.OA)}else n=new URL(a.OA+a.wE)}else n=new URL(a.OA+a.DV);if(null!=e.error&&n.searchParams.set("oauth_error",e.error),r)try{await (0,A.D2)(r)}catch{P.error("TeamInvite: Unable to accept invite after oauth")}else if(o)try{let{success:n,__typename:i}=await (0,U.C)(o,e.created);"GenericError"!==i&&n||u.warning(Error("InviteLink: Unable to process link after oauth authorization"),{invite_link_id:o,accept_failure_reason:i})}catch(e){u.warning(e`InviteLink: Unable to process link after oauth authorization`,{invite_link_id:o,error_message:e.message})}e.loginSuccess?T.Rf(()=>{let e=n.toString();i&&window.location.replace(i),window.location.href=e}):window.location.href=n.toString()},C=(e,n)=>{let{query:i}=r.parse(window.location.search||"",!0),t={pathname:a.ym,query:{app_source:y._v,...i}},o=r.format(t);return(0,d.Z)(o,{method:"POST",headers:{[g.Jd]:S._R},body:JSON.stringify({email:e,password:n,sstSupported:!0})})},G=(e,n={},i=x)=>{let r=new URL(`${a.OA}/api/auth/${e}`),d=new URLSearchParams(r.search);Object.keys(n).map(e=>d.set(e,n[e]));let l=(0,v.jS)("app_source")||y._v;d.set("app_source",l),d.set("sstSupported","true"),_.ready(()=>{let{anonID:e}=_.getAnalyticsIds();d.set("anon_id",e),(0,o.B)()&&d.set("device_id",window.amplitude.getInstance().options.deviceId);let n=`${r.toString()}?${d.toString()}`,l=window.open(n,`loom_${(0,f.Z)()}_popup`,"width=600,height=800"),c=e=>{let n;try{let r=new URL(e.origin)?.origin;if(["https://js.stripe.com"].includes(r))return;if("string"==typeof e.data)n=(0,s.FL)(e.data,{type:"default-oauth-type"},V),"default-oauth-type"===n.type&&u.warning(Error("Malformed auth data, falling back to default oauth type"),{event:e,team:N.SZ.Outreach}),(r!==a.OA||n.type!==t.D)&&(n.invalidLogin=!0),window.removeEventListener("message",c),l?.close(),i(n);else throw Error("Malformed oauth data")}catch(n){u.error("Auth Error",{message:n.message,origin:e.origin,team:N.SZ.Outreach,event:e},{feature:N.L0.Authentication});return}};window.addEventListener("message",c)})},R=()=>{m.h.dispatch((0,b.wu)(null)),m.h.dispatch((0,b.Zx)(null)),m.h.dispatch((0,b.VN)(null))},q=e=>(0,l.J$)().query({query:E(),variables:{email:e},fetchPolicy:"no-cache"}),B=(e,n)=>e!==h.e6&&(!n||!!(0,D.Z)(n)||e.includes("desktop"))},95180:function(e,n,i){"use strict";var t=i(49003),a=i(17563);n.Z=e=>!!(e&&!e.startsWith(t.OA)&&e!==t.Gz&&!("/"==e[0]&&(1==e.length||"/"!=e[1]&&"\\"!=e[1]))&&!e.startsWith(a.t4)&&!e.startsWith(t.MB))},87480:function(e,n,i){"use strict";i.d(n,{k:function(){return a}});var t=i(44314);async function a(){let e=await (0,t.Z)("https://location.loom.com",{method:"GET"});return{country:e.headers.get("x-loom-country")??"",city:e.headers.get("x-loom-city")??"",postalCode:e.headers.get("x-loom-postal-code")??"",latitude:parseFloat(e.headers.get("x-loom-latitude")??""),longitude:parseFloat(e.headers.get("x-loom-longitude")??"")}}},19370:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GetPrimaryAuthTypeForEmail"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"email"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"response"},name:{kind:"Name",value:"getPrimaryAuthTypeForEmail"},arguments:[{kind:"Argument",name:{kind:"Name",value:"email"},value:{kind:"Variable",name:{kind:"Name",value:"email"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GetPrimaryAuthTypePayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirectUri"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Error"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:246}};n.loc.source={body:"query GetPrimaryAuthTypeForEmail($email: String!) {\n  response: getPrimaryAuthTypeForEmail(email: $email) {\n    __typename\n    ... on GetPrimaryAuthTypePayload {\n      authType\n      redirectUri\n    }\n    ... on Error {\n      message\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function t(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.GetPrimaryAuthTypeForEmail=function(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,o=new Set,d=new Set;for(r.forEach(function(e){d.add(e)});d.size>0;){var l=d;d=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return o.forEach(function(n){var i=t(e,n);i&&a.definitions.push(i)}),a}(n,"GetPrimaryAuthTypeForEmail")},83380:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"UpdateUserProperty"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"value"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BasicScalar"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"result"},name:{kind:"Name",value:"updateUserProperty"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"value"},value:{kind:"Variable",name:{kind:"Name",value:"value"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UpdatedPersonProperty"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"property"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"created"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"updated"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:254}};n.loc.source={body:"mutation UpdateUserProperty($name: String!, $value: BasicScalar!) {\n  result: updateUserProperty(name: $name, value: $value) {\n    ... on UpdatedPersonProperty {\n      property {\n        name\n        value\n      }\n      created\n      updated\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function t(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.UpdateUserProperty=function(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,o=new Set,d=new Set;for(r.forEach(function(e){d.add(e)});d.size>0;){var l=d;d=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return o.forEach(function(n){var i=t(e,n);i&&a.definitions.push(i)}),a}(n,"UpdateUserProperty")},31245:function(e){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AcceptInviteLinkInvitation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"inviteLinkId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isNewUser"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"acceptInviteLinkInvitation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"inviteLinkId"},value:{kind:"Variable",name:{kind:"Name",value:"inviteLinkId"}}},{kind:"Argument",name:{kind:"Name",value:"isNewUser"},value:{kind:"Variable",name:{kind:"Name",value:"isNewUser"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AcceptInviteLinkInvitationPayload"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirect"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"GenericError"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InviteLinkDisabledError"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirect"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InviteLinkNotFoundError"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirect"},arguments:[],directives:[]}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InviteLinkWorkspaceSsoError"}},directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"redirect"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:555}};n.loc.source={body:"mutation AcceptInviteLinkInvitation($inviteLinkId: ID!, $isNewUser: Boolean!) {\n  acceptInviteLinkInvitation(\n    inviteLinkId: $inviteLinkId\n    isNewUser: $isNewUser\n  ) {\n    __typename\n    ... on AcceptInviteLinkInvitationPayload {\n      success\n      redirect\n    }\n    ... on GenericError {\n      message\n      error\n    }\n    ... on InviteLinkDisabledError {\n      success\n      redirect\n    }\n    ... on InviteLinkNotFoundError {\n      success\n      redirect\n    }\n    ... on InviteLinkWorkspaceSsoError {\n      success\n      redirect\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var i={};function t(e,n){for(var i=0;i<e.definitions.length;i++){var t=e.definitions[i];if(t.name&&t.name.value==n)return t}}n.definitions.forEach(function(e){if(e.name){var n=new Set;(function e(n,i){if("FragmentSpread"===n.kind)i.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&i.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach(function(n){e(n,i)}),n.variableDefinitions&&n.variableDefinitions.forEach(function(n){e(n,i)}),n.definitions&&n.definitions.forEach(function(n){e(n,i)})})(e,n),i[e.name.value]=n}}),e.exports=n,e.exports.AcceptInviteLinkInvitation=function(e,n){var a={kind:e.kind,definitions:[t(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var r=i[n]||new Set,o=new Set,d=new Set;for(r.forEach(function(e){d.add(e)});d.size>0;){var l=d;d=new Set,l.forEach(function(e){o.has(e)||(o.add(e),(i[e]||new Set).forEach(function(e){d.add(e)}))})}return o.forEach(function(n){var i=t(e,n);i&&a.definitions.push(i)}),a}(n,"AcceptInviteLinkInvitation")}}]);
//# sourceMappingURL=https://www.loom.com/admin/sourcemaps/js/2973-ffbd11b324de0cc04ad9.js.map